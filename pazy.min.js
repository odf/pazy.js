var ArrayNode,BASE,BitmapIndexedNode,Collection,CollisionNode,CountedExtensions,CountedSeq,DefaultExtensions,EmptyNode,FingerTreeType,HALFBASE,HashLeaf,HashLeafWithValue,HashMap,HashSet,IntLeaf,IntLeafWithValue,IntMap,IntSet,LongInt,ONE,OrderMeasure,Partition,ProxyNode,Queue,Rational,Sequence,SizeMeasure,SortedExtensions,SortedSeqType,Stack,TWO,Void,ZERO,a,a2,a3,add,b,c,cleanup,cmp,d,digitTimesDigit,div,divmod,dump,equalKeys,hashCode,log,mod,mul,pow,quicktest,rdump,recur,resolve,seqTimesDigit,split,sqrt,sub,suspend,util,_ref,_ref10,_ref11,_ref12,_ref13,_ref14,_ref15,_ref16,_ref17,_ref18,_ref19,_ref2,_ref3,_ref4,_ref5,_ref6,_ref7,_ref8,_ref9,__bind=function(a,b){return function(){return a.apply(b,arguments)}},__slice=Array.prototype.slice,__hasProp=Object.prototype.hasOwnProperty,__extends=function(a,b){function d(){this.constructor=a}for(var c in b)__hasProp.call(b,c)&&(a[c]=b[c]);d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype;return a},__indexOf=Array.prototype.indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(this[b]===a)return b;return-1};typeof exports!="undefined"&&exports!==null?exports:exports=(_ref=this.pazy)!=null?_ref:this.pazy={},exports.suspend=function(a){var b;b=null;return function(){a&&(b=a(),a=null);return b}},exports.recur=function(a){return{recur__:a}},exports.resolve=function(a){while(a!=null?a.recur__:void 0)a=a.recur__();return a},exports.scope=function(a,b){return b.apply(null,a)},typeof require!="undefined"?(require.paths.unshift(__dirname),_ref2=require("functional"),recur=_ref2.recur,resolve=_ref2.resolve):(_ref3=this.pazy,recur=_ref3.recur,resolve=_ref3.resolve),Sequence=function(){function b(a){var c,d,e,f;if(a==null)this.first=function(){},this.rest=function(){return null};else if(typeof a.toSeq=="function")f=a.toSeq(),f!=null?(this.first=function(){return f.first()},this.rest=function(){return f.rest()}):(this.first=function(){},this.rest=function(){return null});else if(typeof a.first=="function"&&typeof a.rest=="function")this.first=function(){return a.first()},this.rest=function(){return a.rest()};else if(typeof a.length=="number")d=a.length,e=function(c){while(c<d&&typeof a[c]=="undefined")c+=1;return c<d?b.conj(a[c],function(){return e(c+1)}):null},c=e(0),c?(this.first=function(){return c.first()},this.rest=function(){return c.rest()}):(this.first=function(){},this.rest=function(){return null});else throw new Error("cannot make a sequence from "+a)}var a;b.accepts=function(a){return a==null||typeof a.toSeq=="function"||typeof a.first=="function"&&typeof a.rest=="function"||typeof a.length=="number"},b.conj=function(a,c,d){var e;c==null&&(c=function(){return null}),d==null&&(d=null);if(d==="forced"){e=c();return new b({first:function(){return a},rest:function(){return e}})}return new b({first:function(){return a},rest:function(){var a;a=c();return(this.rest=function(){return a})()}})},b.from=function(a){return b.conj(a,__bind(function(){return this.from(a+1)},this))},b.range=function(a,b){return this.take__(this.from(a),b-a+1)},b.constant=function(a){return b.conj(a,__bind(function(){return this.constant(a)},this))},a=function(a){var c;return a&&(c=new b(a))&&!c.empty()?c:null},b.prototype.S__=b,b.memo=function(b,c){this[b]=function(b){return c.call(this,a(b))},this[""+b+"__"]=function(a){return c.call(this,a)};return this.prototype[b]=function(){var a;a=c.call(this.S__,this);return(this[b]=function(){return a})()}},b.method=function(b,c){this[b]=function(){var b,d;d=arguments[0],b=2<=arguments.length?__slice.call(arguments,1):[];return c.call.apply(c,[this,a(d)].concat(__slice.call(b)))},this[""+b+"__"]=function(){var a,b;b=arguments[0],a=2<=arguments.length?__slice.call(arguments,1):[];return c.call.apply(c,[this,b].concat(__slice.call(a)))};return this.prototype[b]=function(){var a;a=1<=arguments.length?__slice.call(arguments,0):[];return c.call.apply(c,[this.S__,this].concat(__slice.call(a)))}},b.operator=function(b,c){this[b]=function(){var b,d,e;e=arguments[0],d=arguments[1],b=3<=arguments.length?__slice.call(arguments,2):[];return c.call.apply(c,[this,a(e),a(d)].concat(__slice.call(b)))},this[""+b+"__"]=function(){var a,b,d;d=arguments[0],b=arguments[1],a=3<=arguments.length?__slice.call(arguments,2):[];return c.call.apply(c,[this,d,b].concat(__slice.call(a)))};return this.prototype[b]=function(){var b,d;d=arguments[0],b=2<=arguments.length?__slice.call(arguments,1):[];return c.call.apply(c,[this.S__,this,a(d)].concat(__slice.call(b)))}},b.method("empty",function(a){return a==null||typeof a.first()=="undefined"}),b.memo("size",function(a){var b;b=function(a,c){return a?recur(function(){return b(a.rest(),c+1)}):c};return this.empty__(a)?0:resolve(b(a,0))}),b.memo("last",function(a){var b;b=function(a){return a.rest()?recur(function(){return b(a.rest())}):a.first()};if(!this.empty__(a))return resolve(b(a))}),b.method("take",function(a,c){return this.empty__(a)||c<=0?null:b.conj(a.first(),__bind(function(){return this.take__(a.rest(),c-1)},this))}),b.method("takeWhile",function(a,c){return this.empty__(a)||!c(a.first())?null:b.conj(a.first(),__bind(function(){return this.takeWhile__(a.rest(),c)},this))}),b.method("drop",function(a,b){var c;c=function(a,b){return a&&b>0?recur(function(){return c(a.rest(),b-1)}):a};return this.empty__(a)?null:resolve(c(a,b))}),b.method("dropWhile",function(a,b){var c;c=function(a){return a&&b(a.first())?recur(function(){return c(a.rest())}):a};return this.empty__(a)?null:resolve(c(a))}),b.method("get",__bind(function(a,b){var c;if(b>=0)return(c=this.drop__(a,b))!=null?c.first():void 0},b)),b.method("select",function(a,c){return this.empty__(a)?null:c(a.first())?b.conj(a.first(),__bind(function(){return this.select__(a.rest(),c)},this)):a.rest()?this.select__(this.dropWhile__(a.rest(),function(a){return!c(a)}),c):null}),b.method("find",function(a,b){var c;return(c=this.select__(a,b))!=null?c.first():void 0}),b.method("forall",function(a,b){return!this.select__(a,function(a){return!b(a)})}),b.method("map",function(a,c){return this.empty__(a)?null:b.conj(c(a.first()),__bind(function(){return this.map__(a.rest(),c)},this))}),b.method("accumulate",function(a,c,d){var e;if(this.empty__(a))return null;e=d(c,a.first());return b.conj(e,__bind(function(){return this.accumulate__(a.rest(),e,d)},this))}),b.method("sums",function(a){return this.accumulate__(a,0,function(a,b){return a+b})}),b.method("products",function(a){return this.accumulate__(a,1,function(a,b){return a*b})}),b.method("reduce",function(a,b,c){return this.empty__(a)?b:this.accumulate__(a,b,c).last()}),b.method("sum",function(a){return this.reduce__(a,0,function(a,b){return a+b})}),b.method("product",function(a){return this.reduce__(a,1,function(a,b){return a*b})}),b.method("fold",function(a,b){return this.reduce__(a.rest(),a.first(),b)}),b.method("max",function(a){return this.fold__(a,function(a,b){return b>a?b:a})}),b.method("min",function(a){return this.fold__(a,function(a,b){return b<a?b:a})}),b.operator("combine",function(a,c,d){return this.empty__(a)?b.map(c,function(a){return d(null,a)}):this.empty__(c)?b.map(a,function(a){return d(a,null)}):b.conj(d(a.first(),c.first()),__bind(function(){return this.combine__(a.rest(),c.rest(),d)},this))}),b.operator("add",function(a,b){return this.combine__(a,b,function(a,b){return a+b})}),b.operator("sub",function(a,b){return this.combine__(a,b,function(a,b){return a-b})}),b.operator("mul",function(a,b){return this.combine__(a,b,function(a,b){return a*b})}),b.operator("div",function(a,b){return this.combine__(a,b,function(a,b){return a/b})}),b.operator("equals",function(a,b){return this.find__(this.combine__(a,b,function(a,b){return a===b}),function(a){return!a})==null}),b.operator("interleave",function(a,c){return this.empty__(a)?c:b.conj(a.first(),__bind(function(){return this.interleave__(c,a.rest())},this))}),b.operator("lazyConcat",function(a,c){return a?b.conj(a.first(),__bind(function(){return this.lazyConcat__(a.rest(),c)},this)):c()}),b.operator("concat",function(a,b){return this.empty__(a)?b:this.lazyConcat__(a,function(){return b})}),b.method("flatten",function(b){return this.empty__(b)?null:b.first()?this.lazyConcat__(a(b.first()),__bind(function(){return this.flatten__(b.rest())},this)):b.rest()?this.flatten__(this.dropWhile__(b.rest(),function(b){var c;return(c=a(b))!=null?!c.first():!void 0})):null}),b.method("flatMap",function(a,b){return this.flatten__(this.map__(a,b))}),b.operator("cartesian",function(a,b){return this.flatMap__(a,__bind(function(a){return this.map__(b,function(b){return[a,b]})},this))}),b.method("each",function(a,b){var c;c=function(a){if(a){b(a.first());return recur(function(){return c(a.rest())})}};if(!this.empty__(a))return resolve(c(a))}),b.method("reverse",function(a){var c;c=__bind(function(a,d){return d?recur(__bind(function(){return c(b.conj(d.first(),function(){return a}),d.rest())},this)):a},this);return this.empty__(a)?null:resolve(c(null,a))}),b.method("forced",function(a){return this.empty__(a)?null:b.conj(a.first(),__bind(function(){return this.forced__(a.rest())},this),"forced")}),b.method("into",function(a,c){var d,e;if(c==null)return this.reduce__(a,null,function(a,c){return b.conj(c,function(){return a})});if(typeof c.plus=="function")return this.reduce__(a,c,function(a,b){return a.plus(b)});if(typeof c.length=="number"){d=function(){var a,b,d;d=[];for(a=0,b=c.length;a<b;a++)e=c[a],d.push(e);return d}(),this.each__(a,function(a){return d.push(a)});return d}throw new Error("cannot inject into #{target}")}),b.method("join",function(a,b){return this.into__(a,[]).join(b)}),b.prototype.toString=function(a){var c,d,e;a==null&&(a=10),e=a>0?[this.take(a),this.get(a)!=null]:[this,!1],d=e[0],c=e[1];return"("+b.join(d,", ")+(c?", ...)":")")};return b}.call(this),typeof exports!="undefined"&&exports!==null?exports:exports=(_ref4=this.pazy)!=null?_ref4:this.pazy={},exports.Sequence=Sequence,typeof require!="undefined"?(require.paths.unshift(__dirname),Sequence=require("sequence").Sequence):Sequence=this.pazy.Sequence,util={arrayWith:function(a,b,c){var d,e,f;f=[];for(d=0,e=a.length;0<=e?d<e:d>e;0<=e?d++:d--)f.push(d===b?c:a[d]);return f},arrayWithInsertion:function(a,b,c){var d,e,f;f=[];for(d=0,e=a.length;0<=e?d<=e:d>=e;0<=e?d++:d--)f.push(d<b?a[d]:d>b?a[d-1]:c);return f},arrayWithout:function(a,b){var c,d,e;e=[];for(c=0,d=a.length;0<=d?c<d:c>d;0<=d?c++:c--)c!==b&&e.push(a[c]);return e},isKey:function(a){return typeof a=="number"&&4294967296>a&&a>=0&&a%1===0},mask:function(a,b){return a>>27-b&31},bitCount:function(a){a-=a>>1&1431655765,a=(a&858993459)+(a>>2&858993459),a=(a&252645135)+(a>>4&252645135),a+=a>>8;return a+(a>>16)&63},indexForBit:function(a,b){return util.bitCount(a&b-1)},bitPosAndIndex:function(a,b,c){var d;d=1<<util.mask(b,c);return[d,util.indexForBit(a,d)]}},EmptyNode={size:0,get:function(a,b,c){return},elements:null,plus:function(a,b,c){return c},minus:function(a,b,c){return this},toString:function(){return"EmptyNode"}},BitmapIndexedNode=function(){function a(a,b,c){var d;d=arguments.length===0?[0,[],0]:[a,b,c],this.bitmap=d[0],this.progeny=d[1],this.size=d[2],this.elements=Sequence.flatMap(this.progeny,function(a){return a!=null?a.elements:void 0})}a.prototype.get=function(a,b,c){var d,e,f;f=util.bitPosAndIndex(this.bitmap,b,a),d=f[0],e=f[1];if((this.bitmap&d)!==0)return this.progeny[e].get(a+5,b,c)},a.prototype.plus=function(b,c,d){var e,f,g,h,i,j,k,l,m,n,o;o=util.bitPosAndIndex(this.bitmap,c,b),g=o[0],h=o[1];if((this.bitmap&g)===0){j=util.bitCount(this.bitmap);if(j<8){k=util.arrayWithInsertion(this.progeny,h,d);return new a(this.bitmap|g,k,this.size+1)}m=function(){var a;a=[];for(i=0;i<=31;i++)f=1<<i,a.push((this.bitmap&f)!==0?this.progeny[util.indexForBit(this.bitmap,f)]:void 0);return a}.call(this);return new ArrayNode(m,util.mask(c,b),d,this.size+1)}n=this.progeny[h],l=n.plus(b+5,c,d);if(this.bitmap===1<<h)return new ProxyNode(h,l);e=util.arrayWith(this.progeny,h,l);return new a(this.bitmap,e,this.size+l.size-n.size)},a.prototype.minus=function(b,c,d){var e,f,g,h,i,j,k,l,m;m=util.bitPosAndIndex(this.bitmap,c,b),e=m[0],g=m[1],l=this.progeny[g],k=l.minus(b+5,c,d),k!=null?(i=this.bitmap,j=this.size+k.size-l.size,h=util.arrayWith(this.progeny,g,k)):(i=this.bitmap^e,j=this.size-1,h=util.arrayWithout(this.progeny,g)),f=util.bitCount(i);if(f===0)return null;if(f===1){k=h[0];return k.progeny!=null?new ProxyNode(util.bitCount(i-1),k):k}return new a(i,h,j)},a.prototype.toString=function(a){var b,c,d,e;a==null&&(a=""),e=a+" ",c=[];for(d=0;d<=31;d++)b=1<<d,(this.bitmap&b)!==0&&c.push(this.progeny[util.indexForBit(this.bitmap,b)].toString(e));if(c.length===1)return"{"+c[0]+"}";c.unshift("");return"{"+c.join("\n"+e)+"}"};return a}(),ProxyNode=function(){function a(a,b){this.child_index=a,this.progeny=b,this.size=this.progeny.size,this.elements=this.progeny.elements}a.prototype.get=function(a,b,c){if(this.child_index===util.mask(b,a))return this.progeny.get(a+5,b,c)},a.prototype.plus=function(b,c,d){var e,f,g;g=util.mask(c,b);if(this.child_index===g)return new a(g,this.progeny.plus(b+5,c,d));f=1<<this.child_index|1<<g,e=g<this.child_index?[d,this.progeny]:[this.progeny,d];return new BitmapIndexedNode(f,e,this.size+d.size)},a.prototype.minus=function(b,c,d){var e;e=this.progeny.minus(b+5,c,d);return(e!=null?e.progeny:void 0)!=null?new a(this.child_index,e):e},a.prototype.toString=function(a){a==null&&(a="");return"."+this.progeny.toString(a+" ")};return a}(),ArrayNode=function(){function a(a,b,c,d){this.size=d,this.progeny=util.arrayWith(a,b,c),this.elements=Sequence.select(this.progeny,function(a){return a}).flatMap(function(a){return a.elements})}a.prototype.get=function(a,b,c){var d;d=util.mask(b,a);if(this.progeny[d]!=null)return this.progeny[d].get(a+5,b,c)},a.prototype.plus=function(b,c,d){var e,f,g;e=util.mask(c,b);if(this.progeny[e]!=null){g=this.progeny[e].plus(b+5,c,d),f=this.size+g.size-this.progeny[e].size;return new a(this.progeny,e,g,f)}return new a(this.progeny,e,d,this.size+1)},a.prototype.minus=function(b,c,d){var e,f,g,h,i,j;g=util.mask(c,b),i=this.progeny[g].minus(b+5,c,d);if(i!=null)return new a(this.progeny,g,i,this.size-1);j=function(){var a,b;b=[];for(h=1,a=this.progeny.length;1<=a?h<a:h>a;1<=a?h++:h--)h!==g&&this.progeny[h]&&b.push(h);return b}.call(this);if(j.length<=4){f=Sequence.reduce(j,0,function(a,b){return a|1<<b}),e=function(){var a,b,c;c=[];for(a=0,b=j.length;a<b;a++)h=j[a],c.push(this.progeny[h]);return c}.call(this);return new BitmapIndexedNode(f,e,this.size-1)}return new a(this.progeny,g,null,this.size-1)},a.prototype.toString=function(a){var b,c,d;a==null&&(a=""),c=a+" ",b=function(){var a,b,e,f;e=this.progeny,f=[];for(a=0,b=e.length;a<b;a++)d=e[a],d!=null&&f.push(d.toString(c));return f}.call(this);if(b.length===1)return"["+b[0]+"]";b.unshift("");return"["+b.join("\n"+c)+"]"};return a}(),Collection=function(){function a(a){var b,c;this.root=a,(b=this.root)!=null?b:this.root=EmptyNode,this.entries=(c=this.root)!=null?c.elements:void 0}a.prototype.size=function(){return this.root.size},a.prototype.each=function(a){var b;return a!=null?(b=this.entries)!=null?b.each(a):void 0:this},a.prototype.update_=function(a){return a!==this.root?new this.constructor(a):this},a.prototype.plus=function(){return this.plusAll(arguments)},a.prototype.plusAll=function(a){return this.update_(Sequence.reduce(a,this.root,this.constructor.plusOne))},a.prototype.minus=function(){return this.minusAll(arguments)},a.prototype.minusAll=function(a){return this.update_(Sequence.reduce(a,this.root,this.constructor.minusOne))},a.prototype.map=function(a){return(new this.constructor).plusAll(Sequence.map(this.entries,a))},a.prototype.toSeq=function(){return this.entries},a.prototype.toArray=function(){return Sequence.into(this.entries,[])},a.prototype.toString=function(){return""+this.constructor.name+"("+this.root+")"};return a}(),IntLeaf=function(){function a(a){this.key=a,this.elements=Sequence.conj(this.key)}a.prototype.size=1,a.prototype.get=function(a,b,c){return b===this.key},a.prototype.plus=function(a,b,c){return(new BitmapIndexedNode).plus(a,this.key,this).plus(a,b,c)},a.prototype.minus=function(a,b,c){return null},a.prototype.toString=function(){return""+this.key};return a}(),IntSet=function(){function a(){a.__super__.constructor.apply(this,arguments)}__extends(a,Collection),a.name="IntSet",a.prototype.contains=function(a){return this.root.get(0,a)===!0},a.plusOne=function(a,b){return util.isKey(b)&&!a.get(0,b)?a.plus(0,b,new IntLeaf(b)):a},a.minusOne=function(a,b){return util.isKey(b)&&(a!=null?a.get(0,b):void 0)?a.minus(0,b):a};return a}(),IntLeafWithValue=function(){function a(a,b){this.key=a,this.value=b,this.elements=Sequence.conj([this.key,this.value])}a.prototype.size=1,a.prototype.get=function(a,b,c){if(b===this.key)return this.value},a.prototype.plus=function(a,b,c){return this.key===b?c:(new BitmapIndexedNode).plus(a,this.key,this).plus(a,b,c)},a.prototype.minus=function(a,b,c){return null},a.prototype.toString=function(){return""+this.key+" ~> "+this.value};return a}(),IntMap=function(){function a(){a.__super__.constructor.apply(this,arguments)}__extends(a,Collection),a.name="IntMap",a.prototype.get=function(a){return this.root.get(0,a)},a.plusOne=function(a,b){var c,d;c=b[0],d=b[1];return util.isKey(c)&&a.get(0,c)!==d?a.plus(0,c,new IntLeafWithValue(c,d)):a},a.minusOne=function(a,b){return util.isKey(b)&&typeof (a!=null?a.get(0,b):void 0)!="undefined"?a.minus(0,b):a};return a}(),hashCode=function(a){if(a==null)return 0;if(typeof a.hashCode=="function"&&util.isKey(a.hashCode()))return a.hashCode();if(util.isKey(a))return a;if(typeof a=="string"&&a.length<=1)return a.length===0?1:a.charCodeAt(0);if(Sequence.accepts(a))return Sequence.reduce(a,0,function(a,b){return a*37+hashCode(b)&4294967295});if(typeof a.toString=="function")return hashCode(a.toString());try{return hashCode(String(a))}catch(b){return hashCode(Object.prototype.toString.call(a))}},equalKeys=function(a,b){return typeof a=="string"||typeof b=="string"?a===b:Sequence.accepts(a)&&Sequence.accepts(b)?Sequence.find(Sequence.combine(a,b,equalKeys),function(a){return!a})==null:a!=null&&typeof a.equals=="function"?a.equals(b):b!=null&&typeof b.equals=="function"?b.equals(a):a===b},CollisionNode=function(){function a(a,b){this.hash=a,this.bucket=b,this.bucket==null&&(this.bucket=[]),this.size=this.bucket.length,this.elements=Sequence.flatMap(this.bucket,function(a){return a!=null?a.elements:void 0})}a.prototype.get=function(a,b,c){var d;d=Sequence.find(this.bucket,function(a){return equalKeys(a.key,c)});if(d!=null)return d.get(a,b,c)},a.prototype.plus=function(b,c,d){var e;if(c!==this.hash)return(new BitmapIndexedNode).plus(b,this.hash,this).plus(b,c,d);e=this.bucketWithout(d.key),e.push(d);return new a(c,e)},a.prototype.minus=function(b,c,d){switch(this.bucket.length){case 0:case 1:return null;case 2:return Sequence.find(this.bucket,function(a){return!equalKeys(a.key,d)});default:return new a(c,this.bucketWithout(d))}},a.prototype.toString=function(){return""+this.bucket.join("|")},a.prototype.bucketWithout=function(a){var b,c,d,e,f;e=this.bucket,f=[];for(c=0,d=e.length;c<d;c++)b=e[c],equalKeys(b.key,a)||f.push(b);return f};return a}(),HashLeaf=function(){function a(a,b){this.hash=a,this.key=b,this.elements=Sequence.conj(this.key)}a.prototype.size=1,a.prototype.get=function(a,b,c){if(equalKeys(c,this.key))return!0},a.prototype.plus=function(a,b,c){var d;b===this.hash?d=new CollisionNode(b):d=new BitmapIndexedNode;return d.plus(a,this.hash,this).plus(a,b,c)},a.prototype.minus=function(a,b,c){return null},a.prototype.toString=function(){return""+this.key};return a}(),HashSet=function(){function a(){a.__super__.constructor.apply(this,arguments)}__extends(a,Collection),a.name="HashSet",a.prototype.contains=function(a){return this.root.get(0,hashCode(a),a)===!0},a.plusOne=function(a,b){var c;c=hashCode(b);return a.get(0,c,b)?a:a.plus(0,c,new HashLeaf(c,b))},a.minusOne=function(a,b){var c;c=hashCode(b);return(a!=null?a.get(0,c,b):void 0)?a.minus(0,c,b):a};return a}(),HashLeafWithValue=function(){function a(a,b,c){this.hash=a,this.key=b,this.value=c,this.elements=Sequence.conj([this.key,this.value])}a.prototype.size=1,a.prototype.get=function(a,b,c){if(equalKeys(c,this.key))return this.value},a.prototype.plus=function(a,b,c){var d;if(equalKeys(this.key,c.key))return c;b===this.hash?d=new CollisionNode(b):d=new BitmapIndexedNode;return d.plus(a,this.hash,this).plus(a,b,c)},a.prototype.minus=function(a,b,c){return null},a.prototype.toString=function(){return""+this.key+" ~> "+this.value};return a}(),HashMap=function(){function a(){a.__super__.constructor.apply(this,arguments)}__extends(a,Collection),a.name="HashMap",a.prototype.get=function(a){return this.root.get(0,hashCode(a),a)},a.plusOne=function(a,b){var c,d,e;d=b[0],e=b[1],c=hashCode(d);return a.get(0,c,d)===e?a:a.plus(0,c,new HashLeafWithValue(c,d,e))},a.minusOne=function(a,b){var c;c=hashCode(b);return typeof (a!=null?a.get(0,c,b):void 0)!="undefined"?a.minus(0,c,b):a};return a}(),typeof exports!="undefined"&&exports!==null?exports:exports=(_ref5=this.pazy)!=null?_ref5:this.pazy={},exports.IntSet=IntSet,exports.IntMap=IntMap,exports.HashMap=HashMap,exports.HashSet=HashSet,typeof require!="undefined"?(require.paths.unshift(__dirname),Sequence=require("sequence").Sequence,HashSet=require("indexed").HashSet):(_ref6=this.pazy,Sequence=_ref6.Sequence,HashSet=_ref6.HashSet),Sequence.method("uniq",function(a,b){var c;b==null&&(b=new HashSet);if(this.empty__(a))return null;c=a.first();return b.contains(c)?this.uniq__(a.rest(),b):Sequence.conj(c,__bind(function(){return this.uniq__(a.rest(),b.plus(c))},this))}),typeof require!="undefined"?(require.paths.unshift("#{__dirname}/../lib"),Sequence=require("sequence").Sequence,_ref7=require("functional"),recur=_ref7.recur,resolve=_ref7.resolve,suspend=_ref7.suspend):(Sequence=pazy.Sequence,recur=pazy.recur,resolve=pazy.resolve,suspend=pazy.suspend),Void=function(){function a(){}return a}(),DefaultExtensions=function(){function a(){}a.prototype.after=function(a){return a===void 0?this:new this.constructor(this.data.after(a))},a.prototype.before=function(a){return a===void 0?this:new this.constructor(this.data.before(a))},a.prototype.concat=function(a){return a==null?this:new this.constructor(this.data.concat(a.data))},a.prototype.reverse=function(){return new this.constructor(this.data.reverse())},a.prototype.plus=a.prototype.before;return a}(),FingerTreeType=function(){function a(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q;b==null&&(b=DefaultExtensions),this.build=function(){return Sequence.reduce(arguments,m,function(a,b){return a.plus(b)})},q=function(b){var c;return b===h||(c=b.constructor,__indexOf.call(n,c)>=0)?b.measure():a.single(b)},o=function(){return Sequence.reduce(arguments,a.empty,function(b,c){return c!=null?a.sum(b,q(c)):b})},p=function(a){var b;return(b=a!=null?a.constructor:void 0)===j||b===k?a.reverse():a},i=function(){function c(a){this.data=a}__extends(c,b),c.prototype.empty=function(){return m},c.prototype.isEmpty=function(){return this.data.isEmpty()},c.prototype.reduceLeft=function(a,b){return this.data.reduceLeft(a,b)},c.prototype.reduceRight=function(a,b){return this.data.reduceRight(a,b)},c.prototype.first=function(){return this.data.first()},c.prototype.last=function(){return this.data.last()},c.prototype.rest=function(){return new c(this.data.rest())},c.prototype.init=function(){return new c(this.data.init())},c.prototype.measure=function(){return this.data.measure()},c.prototype.split=function(b){var d,e,f,g;if(this.data!==h&&b(o(this.data))){g=this.data.split(b,a.empty),d=g[0],f=g[1],e=g[2];return[new c(d),f,new c(e)]}return[this,void 0,new c(h)]},c.prototype.takeUntil=function(a){return this.split(a)[0]},c.prototype.dropUntil=function(a){var b,d,e,f;f=this.split(a),b=f[0],e=f[1],d=f[2];return e===void 0?d:new c(d.data.after(e))},c.prototype.find=function(a){return this.split(a)[1]},c.prototype.toString=function(){return this.data.reduceLeft("",function(a,b){return a+" "+b})};return c}(),j=function(){function a(a,b){this.a=a,this.b=b,this.v=o(this.a,this.b)}a.prototype.reduceLeft=function(a,b){return b(b(a,this.a),this.b)},a.prototype.reduceRight=function(a,b){return a(this.a,a(this.b,b))},a.prototype.asDigit=function(){return new e(this.a,this.b)},a.prototype.measure=function(){return this.v},a.prototype.reverse=function(){return new a(p(this.b),p(this.a))};return a}(),k=function(){function a(a,b,c){this.a=a,this.b=b,this.c=c,this.v=o(this.a,this.b,this.c)}a.prototype.reduceLeft=function(a,b){return b(b(b(a,this.a),this.b),this.c)},a.prototype.reduceRight=function(a,b){return a(this.a,a(this.b,a(this.c,b)))},a.prototype.asDigit=function(){return new f(this.a,this.b,this.c)},a.prototype.measure=function(){return this.v},a.prototype.reverse=function(){return new a(p(this.c),p(this.b),p(this.a))};return a}(),d=function(){function a(a){this.a=a}a.prototype.reduceLeft=function(a,b){return b(a,this.a)},a.prototype.reduceRight=function(a,b){return a(this.a,b)},a.prototype.after=function(a){return new e(a,this.a)},a.prototype.before=function(a){return new e(this.a,a)},a.prototype.first=function(){return this.a},a.prototype.last=function(){return this.a},a.prototype.rest=function(){return h},a.prototype.init=function(){return h},a.prototype.measure=function(){return o(this.a)},a.prototype.split=function(a,b){return[h,this.a,h]},a.prototype.reverse=function(){return new a(p(this.a))};return a}(),e=function(){function b(a,b){this.a=a,this.b=b}b.prototype.reduceLeft=function(a,b){return b(b(a,this.a),this.b)},b.prototype.reduceRight=function(a,b){return a(this.a,a(this.b,b))},b.prototype.after=function(a){return new f(a,this.a,this.b)},b.prototype.before=function(a){return new f(this.a,this.b,a)},b.prototype.first=function(){return this.a},b.prototype.last=function(){return this.b},b.prototype.rest=function(){return new d(this.b)},b.prototype.init=function(){return new d(this.a)},b.prototype.asNode=function(){return new j(this.a,this.b)},b.prototype.measure=function(){return o(this.a,this.b)},b.prototype.split=function(b,c){return b(a.sum(c,o(this.a)))?[h,this.a,new d(this.b)]:[new d(this.a),this.b,h]},b.prototype.reverse=function(){return new b(p(this.b),p(this.a))};return b}(),f=function(){function b(a,b,c){this.a=a,this.b=b,this.c=c}b.prototype.reduceLeft=function(a,b){return b(b(b(a,this.a),this.b),this.c)},b.prototype.reduceRight=function(a,b){return a(this.a,a(this.b,a(this.c,b)))},b.prototype.after=function(a){return new g(a,this.a,this.b,this.c)},b.prototype.before=function(a){return new g(this.a,this.b,this.c,a)},b.prototype.first=function(){return this.a},b.prototype.last=function(){return this.c},b.prototype.rest=function(){return new e(this.b,this.c)},b.prototype.init=function(){return new e(this.a,this.b)},b.prototype.asNode=function(){return new k(this.a,this.b,this.c)},b.prototype.measure=function(){return o(this.a,this.b,this.c)},b.prototype.split=function(b,c){var f;f=a.sum(c,o(this.a));return b(f)?[h,this.a,new e(this.b,this.c)]:b(a.sum(f,o(this.b)))?[new d(this.a),this.b,new d(this.c)]:[new e(this.a,this.b),this.c,h]},b.prototype.reverse=function(){return new b(p(this.c),p(this.b),p(this.a))};return b}(),g=function(){function b(a,b,c,d){this.a=a,this.b=b,this.c=c,this.d=d}b.prototype.reduceLeft=function(a,b){return b(b(b(b(a,this.a),this.b),this.c),this.d)},b.prototype.reduceRight=function(a,b){return a(this.a,a(this.b,a(this.c,a(this.d,b))))},b.prototype.first=function(){return this.a},b.prototype.last=function(){return this.d},b.prototype.rest=function(){return new f(this.b,this.c,this.d)},b.prototype.init=function(){return new f(this.a,this.b,this.c)},b.prototype.measure=function(){return o(this.a,this.b,this.c,this.d)},b.prototype.split=function(b,c){var g,i;g=a.sum(c,o(this.a));if(b(g))return[h,this.a,new f(this.b,this.c,this.d)];i=a.sum(g,o(this.b));return b(i)?[new d(this.a),this.b,new e(this.c,this.d)]:b(a.sum(i,o(this.c)))?[new e(this.a,this.b),this.c,new d(this.d)]:[new f(this.a,this.b,this.c),this.d,h]},b.prototype.reverse=function(){return new b(p(this.d),p(this.c),p(this.b),p(this.a))};return b}(),h={isEmpty:function(){return!0},reduceLeft:function(a,b){return a},reduceRight:function(a,b){return b},after:function(a){return new l(a)},before:function(a){return new l(a)},first:function(){},last:function(){},rest:function(){},init:function(){},concat:function(a){return a},measure:function(){return o()},reverse:function(){return this}},m=new i(h),l=function(){function a(a){this.a=a}a.prototype.isEmpty=function(){return!1},a.prototype.reduceLeft=function(a,b){return b(a,this.a)},a.prototype.reduceRight=function(a,b){return a(this.a,b)},a.prototype.after=function(a){return new c(new d(a),function(){return h},new d(this.a))},a.prototype.before=function(a){return new c(new d(this.a),function(){return h},new d(a))},a.prototype.first=function(){return this.a},a.prototype.last=function(){return this.a},a.prototype.rest=function(){return h},a.prototype.init=function(){return h},a.prototype.concat=function(a){return a.after(this.a)},a.prototype.measure=function(){return o(this.a)},a.prototype.split=function(a,b){return[h,this.a,h]},a.prototype.reverse=function(){return this};return a}(),c=function(){function q(a,b,c){this.l=a,this.m=b,this.r=c}var b,c,d,f,i,m,n,p;n=function(a){return function(b,c){return c.reduceLeft(b,a)}},p=function(a){return function(b,c){return b.reduceRight(a,c)}},d=function(a){return a.reduceLeft(h,function(a,b){return a.before(b)})},c=function(a){return a.reduceRight(function(a,b){return Sequence.conj(a,function(){return b})},null)},q.prototype.isEmpty=function(){return!1},q.prototype.measure=function(){var a;a=o(this.l,this.m(),this.r);return(this.measure=function(){return a})()},q.prototype.reduceLeft=function(a,b){var c,d;c=n(b),d=n(c);return c(d(c(a,this.l),this.m()),this.r)},q.prototype.reduceRight=function(a,b){var c,d;c=p(a),d=p(c);return c(this.l,d(this.m(),c(this.r,b)))},q.prototype.after=function(a){var b,c,d,f,h,i;if(this.l.constructor===g){i=this.l,b=i.a,c=i.b,d=i.c,f=i.d,h=new e(a,b);return new q(h,suspend(__bind(function(){return this.m().after(new k(c,d,f))},this)),this.r)}return new q(this.l.after(a),this.m,this.r)},q.prototype.before=function(a){var b,c,d,f,h,i;if(this.r.constructor===g){i=this.r,b=i.a,c=i.b,d=i.c,f=i.d,h=new e(f,a);return new q(this.l,suspend(__bind(function(){return this.m().before(new k(b,c,d))},this)),h)}return new q(this.l,this.m,this.r.before(a))},q.prototype.first=function(){return this.l.first()},q.prototype.last=function(){return this.r.last()},f=function(a,b,c){return a===h?b()===h?d(c):new q(b().first().asDigit(),suspend(__bind(function(){return b().rest()},this)),c):new q(a,b,c)},i=function(a,b,c){return c===h?b()===h?d(a):new q(a,suspend(__bind(function(){return b().init()},this)),b().last().asDigit()):new q(a,b,c)},q.prototype.rest=function(){return f(this.l.rest(),suspend(__bind(function(){return this.m()},this)),this.r)},q.prototype.init=function(){return i(this.l,suspend(__bind(function(){return this.m()},this)),this.r.init())},m=function(a,b){if(a===0)return null;if(a===1||a<0)throw new Error("this should not happen");return a===2||a%3===1?Sequence.conj(function(a,b,c){c.prototype=a.prototype;var d=new c,e=a.apply(d,b);return typeof e=="object"?e:d}(j,b.take(2).into([]),function(){}),function(){return m(a-2,b.drop(2))}):Sequence.conj(function(a,b,c){c.prototype=a.prototype;var d=new c,e=a.apply(d,b);return typeof e=="object"?e:d}(k,b.take(3).into([]),function(){}),function(){return m(a-3,b.drop(3))})},b=function(a,d,e){var f,g;if(a===h)return Sequence.reduce(Sequence.reverse(d),e,function(a,b){return a.after(b)});if(e===h)return Sequence.reduce(d,a,function(a,b){return a.before(b)});if(a.constructor===l)return b(h,d,e).after(a.a);if(e.constructor===l)return b(a,d,h).before(e.a);g=Sequence.flatten([c(a.r),d,c(e.l)]),f=m(g.size(),g);return new q(a.l,suspend(function(){return b(a.m(),f,e.m())}),e.r)},q.prototype.concat=function(a){return b(this,null,a)},q.prototype.split=function(b,c){var e,g,h,j,k,l,m,n,p,q,r,s;e=a.sum(c,o(this.l));if(b(e)){r=this.l.split(b,c),h=r[0],m=r[1],l=r[2];return[d(h),m,f(l,suspend(__bind(function(){return this.m()},this)),this.r)]}g=a.sum(e,o(this.m()));if(b(g)){s=this.m().split(b,e),j=s[0],n=s[1],k=s[2],p=n.asDigit().split(b,a.sum(e,o(j))),h=p[0],m=p[1],l=p[2];return[i(this.l,function(){return j},h),m,f(l,function(){return k},this.r)]}q=this.r.split(b,g),h=q[0],m=q[1],l=q[2];return[i(this.l,suspend(__bind(function(){return this.m()},this)),h),m,d(l)]},q.prototype.reverse=function(){return new q(this.r.reverse(),suspend(__bind(function(){return this.m().reverse()},this)),this.l.reverse())};return q}(),n=[j,k,d,e,f,g,l,c]}return a}(),SizeMeasure={empty:0,single:function(a){return 1},sum:function(a,b){return a+b}},CountedExtensions=function(){function a(){a.__super__.constructor.apply(this,arguments)}__extends(a,DefaultExtensions),a.prototype.size=function(){return this.measure()},a.prototype.get=function(a){return this.find(function(b){return b>a})},a.prototype.splitAt=function(a){var b,c,d,e;e=this.split(function(b){return b>a}),b=e[0],d=e[1],c=e[2];return[b,c.after(d)]};return a}(),CountedSeq=new FingerTreeType(SizeMeasure,CountedExtensions),OrderMeasure={empty:void 0,single:function(a){return a},sum:function(a,b){return b!=null?b:a}},SortedExtensions=function(a,b){return function(){function h(){h.__super__.constructor.apply(this,arguments)}var c,d,e,f,g;__extends(h,b),c=function(a,b){return b===void 0?a:new a.constructor(a.data.after(b))},d=function(a,b){return b===void 0?a:new a.constructor(a.data.before(b))},e=function(a,b){return new a.constructor(a.data.concat(b.data))},h.prototype.partition=function(b){var d,e,f,g;g=this.split(function(c){return!a(c,b)}),d=g[0],f=g[1],e=g[2];return[d,c(e,f)]},h.prototype.insert=function(a){var b,d,f;f=this.partition(a),b=f[0],d=f[1];return e(b,c(d,a))},h.prototype.deleteAll=function(b){var c,d,f;f=this.partition(b),c=f[0],d=f[1];return e(c,d.dropUntil(function(c){return a(b,c)}))},g=function(b,f,h){var i,j,k,l,m;if(h.isEmpty())return e(b,f);i=h.first(),m=f.split(function(b){return a(i,b)}),j=m[0],l=m[1],k=m[2];return recur(function(){var a;a=e(b,d(j,i));return g(a,h.rest(),c(k,l))})},h.prototype.merge=function(a){return resolve(g(this.empty(),this,a))},f=function(b,e,g){var h,i,j,k,l;if(g.isEmpty())return b;h=g.first(),l=e.split(function(b){return!a(b,h)}),i=l[0],k=l[1],j=l[2];return a(h,k)?recur(function(){return f(b,g.rest(),c(j,k))}):recur(function(){return f(d(b,k),g.rest(),j)})},h.prototype.intersect=function(a){return resolve(f(this.empty(),this,a))},h.prototype.plus=h.prototype.insert;return h}()},SortedSeqType=function(){function a(b,c){b==null&&(b=function(a,b){return a<b}),c==null&&(c=Void),a.__super__.constructor.call(this,OrderMeasure,SortedExtensions(b,c))}__extends(a,FingerTreeType);return a}(),typeof exports!="undefined"&&exports!==null?exports:exports=(_ref8=this.pazy)!=null?_ref8:this.pazy={},exports.FingerTreeType=FingerTreeType,exports.CountedSeq=CountedSeq,exports.SortedSeqType=SortedSeqType,exports.SortedSeq=new SortedSeqType,typeof require!="undefined"?(require.paths.unshift(__dirname),_ref9=require("functional"),recur=_ref9.recur,resolve=_ref9.resolve,HashMap=require("indexed").HashMap):(_ref10=this.pazy,recur=_ref10.recur,resolve=_ref10.resolve,HashMap=_ref10.HashMap),Partition=function(){function b(){this.rank=new HashMap,this.parent=new HashMap}var a;a=function(a,c){var d;d=new b,d.rank=a,d.parent=c;return d},b.prototype.find=function(a){var b,c,d;if(this.parent.get(a)==null){this.parent=this.parent.plus([a,a]),this.rank=this.rank.plus([a,0]);return a}d=__bind(function(a){var b;b=this.parent.get(a);return b===a?b:recur(function(){return d(b)})},this),c=resolve(d(a)),b=__bind(function(a){var d;d=this.parent.get(a),this.parent=this.parent.plus([a,c]);if(d!==a)return recur(function(){return b(d)})},this),resolve(b(a));return c},b.prototype.union=function(b,c){var d,e,f,g;e=this.find(b),g=this.find(c);if(e===g)return this;d=this.rank.get(e),f=this.rank.get(g);return d<f?a(this.rank,this.parent.plus([e,g])):d>f?a(this.rank,this.parent.plus([g,e])):a(this.rank.plus([e,d+1]),this.parent.plus([g,e]))};return b}(),typeof exports!="undefined"&&exports!==null?exports:exports=(_ref11=this.pazy)!=null?_ref11:this.pazy={},exports.Partition=Partition,typeof require!="undefined"?(require.paths.unshift(__dirname),Sequence=require("sequence").Sequence):Sequence=this.pazy.Sequence,Stack=function(){function a(a){this.seq=a}a.prototype.push=function(b){return new a(Sequence.conj(b,__bind(function(){return this.seq},this)))},a.prototype.first=function(){var a;return(a=this.seq)!=null?a.first():void 0},a.prototype.rest=function(){if(this.seq)return new a(this.seq.rest())};return a}(),typeof exports!="undefined"&&exports!==null?exports:exports=(_ref12=this.pazy)!=null?_ref12:this.pazy={},exports.Stack=Stack,typeof require!="undefined"?(require.paths.unshift(__dirname),Sequence=require("sequence").Sequence):Sequence=this.pazy.Sequence,Queue=function(){function b(b,c,d){var e;d?(e=[b,c,d.rest()],this.front=e[0],this.rear=e[1],this.schedule=e[2]):b||c?(this.front=this.schedule=a(b,c,null),this.rear=null):this.front=this.rear=this.schedule=null}var a;a=function(b,c,d){var e;e=Sequence.conj(c.first(),function(){return d});return b?Sequence.conj(b.first(),function(){return a(b.rest(),c.rest(),e)}):e},b.prototype.push=function(a){return new b(this.front,Sequence.conj(a,__bind(function(){return this.rear},this)),this.schedule)},b.prototype.first=function(){var a;return(a=this.front)!=null?a.first():void 0},b.prototype.rest=function(){if(this.front)return new b(this.front.rest(),this.rear,this.schedule)};return b}(),typeof exports!="undefined"&&exports!==null?exports:exports=(_ref13=this.pazy)!=null?_ref13:this.pazy={},exports.Queue=Queue,typeof require!="undefined"?(require.paths.unshift(__dirname),_ref14=require("functional"),recur=_ref14.recur,resolve=_ref14.resolve,Sequence=require("sequence").Sequence):(_ref15=this.pazy,recur=_ref15.recur,resolve=_ref15.resolve,Sequence=_ref15.Sequence),quicktest=(typeof process!="undefined"&&process!==null?process.argv[2]:void 0)==="--test",rdump=function(a){return""+(a?a.into([]).join("|"):"[]")},dump=function(a){return rdump(a!=null?a.reverse():void 0)},quicktest?(_ref16=[1e4,100],BASE=_ref16[0],HALFBASE=_ref16[1],log=function(a){return console.log(a)}):(log=function(a){},_ref17=Sequence.from(1).map(function(a){return[Math.pow(10,2*a),Math.pow(10,a)]}).takeWhile(function(a){var b,c;b=a[0],c=a[1];return 2*b-2!==2*b-1}).last(),BASE=_ref17[0],HALFBASE=_ref17[1]),ZERO=Sequence.conj(0),ONE=Sequence.conj(1),TWO=Sequence.conj(2),cleanup=function(a){var b,c;return(a!=null?(b=a.reverse())!=null?(c=b.dropWhile(function(a){return a===0}))!=null?c.reverse():void 0:void 0:void 0)||null},cmp=function(a,b){var c,d,e;c=Sequence.combine(a,b,function(a,b){return a-b});return(c!=null?(d=c.reverse())!=null?(e=d.dropWhile(function(a){return a===0}))!=null?e.first():void 0:void 0:void 0)||0},add=function(a,b,c){var d,e,f,g,h,i,j;c==null&&(c=0);if(c||a&&b){i=[a||ZERO,b||ZERO],f=i[0],g=i[1],h=f.first()+g.first()+c,j=h>=BASE?[h-BASE,1]:[h,0],e=j[0],d=j[1];return Sequence.conj(e,function(){return add(f.rest(),g.rest(),d)})}return b||a},sub=function(a,b){var c;c=function(a,b,d){var e,f,g,h,i,j,k;d==null&&(d=0);if(d||a&&b){j=[a||ZERO,b||ZERO],g=j[0],h=j[1],i=g.first()-h.first()-d,k=i<0?[i+BASE,1]:[i,0],f=k[0],e=k[1];return Sequence.conj(f,function(){return c(g.rest(),h.rest(),e)})}return b||a};return cleanup(c(a,b))},split=function(a){return[a%HALFBASE,Math.floor(a/HALFBASE)]},digitTimesDigit=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o;if(b<BASE/a)return[a*b,0];l=split(a),c=l[0],d=l[1],m=split(b),e=m[0],f=m[1],n=split(c*f+e*d),i=n[0],j=n[1],k=c*e+i*HALFBASE,o=k<BASE?[k,0]:[k-BASE,1],h=o[0],g=o[1];return[h,d*f+j+g]},seqTimesDigit=function(a,b,c){var d,e,f,g;c==null&&(c=0);if(c||a){f=a||ZERO,g=digitTimesDigit(b,f.first()),e=g[0],d=g[1];return Sequence.conj(e+c,function(){return seqTimesDigit(f.rest(),b,d)})}},mul=function(a,b){var c;c=function(a,b,d){var e;if(b){e=add(a,seqTimesDigit(d,b.first()))||ZERO;return Sequence.conj(e.first(),function(){return c(e.rest(),b.rest(),d)})}return a};return c(null,a,b)},divmod=function(a,b){var c,d,e,f,g,h,i,j,k;g=Math.floor(BASE/(b.last()+1)),j=function(){var c,d,e,f;e=[a,b],f=[];for(c=0,d=e.length;c<d;c++)i=e[c],f.push(new Sequence(seqTimesDigit(i,g)));return f}(),e=j[0],f=j[1],k=[f.size(),f.last()+1],d=k[0],c=k[1],h=function(a,b,e){var i,j;i=(b!=null?b.size():void 0)<d?0:(j=(b!=null?b.last():void 0)*((b!=null?b.size():void 0)>d?BASE:1)||0,Math.floor(j/c)||(cmp(b,f)>=0?1:0));return i?recur(function(){return h(add(a,Sequence.conj(i)),sub(b,seqTimesDigit(f,i)),e)}):e?recur(function(){return h(Sequence.conj(0,function(){return a}),Sequence.conj(e.first(),function(){return b}),e.rest())}):[cleanup(a),b&&div(b,Sequence.conj(g))]};return resolve(h(null,null,e.reverse()))},div=function(a,b){return divmod(a,b)[0]},mod=function(a,b){return divmod(a,b)[1]},pow=function(a,b){var c;c=function(a,b,d){return d?d.first()%2===1?recur(function(){return c(mul(a,b),b,sub(d,ONE))}):recur(function(){return c(a,new Sequence(mul(b,b)),div(d,TWO))}):a};return resolve(c(ONE,a,b))},sqrt=function(a){var b,c;b=a.size();if(b===1)return Sequence.conj(Math.floor(Math.sqrt(a.first())));c=function(b){var d;d=new Sequence(div(add(b,div(a,b)),TWO));return cmp(b,d)?recur(function(){return c(d)}):d};return resolve(c(a.take(b>>1)))},LongInt=function(){function b(a){var b,c,d;a==null&&(a=0),c=function(a){if(a)return Sequence.conj(a%BASE,function(){return c(Math.floor(a/BASE))})},d=a<0?[-a,-1]:[a,1],b=d[0],this.sign__=d[1],this.digits__=cleanup(new Sequence(c(b)))}var a;b.base=function(){return BASE},a=function(a,c){var d;d=new b,d.digits__=cleanup(new Sequence(a)),d.sign__=d.digits__!=null?c:1;return d},b.make=function(a){if(a instanceof b)return a;if(typeof a=="number")return new b(a);throw new Error(""+a+" is not a number")},b.prototype.toString=function(){var a,b,c,d,e,f;c=BASE.toString().slice(1),b=(d=this.digits__)!=null?(e=d.reverse())!=null?e.dropWhile(function(a){return a===0}):void 0:void 0,a=[b!=null?b.first().toString():void 0],b!=null&&(f=b.rest())!=null&&f.each(function(b){var d;d=b.toString();return a.push(""+c.slice(d.length)+d)}),b?this.sign()<0&&a.unshift("-"):a.push("0");return a.join("")},b.prototype.toNumber=function(){var a,b,c,d;b=function(a,c){return c?recur(function(){return b(a*BASE+c.first(),c.rest())}):a},a=(c=this.digits__)!=null?(d=c.reverse())!=null?d.dropWhile(function(a){return a===0}):void 0:void 0;return this.sign()*resolve(b(0,a))},b.operator=function(a,c,d){var e,f,g,h;e=function(){var a,e;a=1<=arguments.length?__slice.call(arguments,0):[];return d.apply(this,function(){var d,f,g,h;g=a.slice(0,c-1),h=[];for(d=0,f=g.length;d<f;d++)e=g[d],h.push(b.make(e));return h}())};for(g=0,h=a.length;g<h;g++)f=a[g],this.prototype[f]=e;return null},b.operator(["neg","-"],1,function(){return a(this.digits__,-this.sign())}),b.operator(["abs"],1,function(){return a(this.digits__,1)}),b.operator(["sign"],1,function(){return this.sign__}),b.operator(["cmp","<=>"],2,function(a){return this.sign()!==a.sign()?this.sign():this.sign()*cmp(this.digits__,a.digits__)}),b.operator(["plus","+"],2,function(b){return this.sign()!==b.sign()?this.minus(b.neg()):a(add(this.digits__,b.digits__),this.sign())}),b.operator(["minus","-"],2,function(b){return this.sign()!==b.sign()?this.plus(b.neg()):this.abs().cmp(b.abs())<0?a(sub(b.digits__,this.digits__),-this.sign()):a(sub(this.digits__,b.digits__),this.sign())}),b.operator(["times","*"],2,function(b){return a(mul(this.digits__,b.digits__),this.sign()*b.sign())}),b.operator(["div","/"],2,function(c){var d;d=this.abs().cmp(c.abs());return d<0?new b(0):d===0?new b(this.sign()*c.sign()):a(div(this.digits__,c.digits__),this.sign()*c.sign())}),b.operator(["mod","%"],2,function(c){var d;d=this.abs().cmp(c.abs());return d<0?this:d===0?new b(0):a(mod(this.digits__,c.digits__),this.sign()*c.sign())}),b.operator(["pow","**"],2,function(b){if(b.sign()>0)return a(pow(this.digits__,b.digits__),this.sign());throw new Error("exponent must not be negative")}),b.operator(["sqrt"],1,function(){if(this.sign()>0)return a(sqrt(this.digits__));throw new Error("number must not be negative")}),b.operator(["gcd"],2,function(a){var b,c,d,e;d=function(a,b){return b.cmp(0)>0?recur(function(){return d(b,a.mod(b))}):a},e=[this.abs(),a.abs()],b=e[0],c=e[1];return b.cmp(c)>0?resolve(d(b,c)):resolve(d(c,b))});return b}(),typeof exports!="undefined"&&exports!==null?exports:exports=(_ref18=this.pazy)!=null?_ref18:this.pazy={},exports.LongInt=LongInt,quicktest&&(a=new LongInt(9950),a2=a["*"](a),a3=a2["*"](a),log("("+a+"**3 + 1) / "+a+"**2 = "+a3.plus(1).div(a2)+" ("+a3.plus(1).mod(a2)+")"),log(""),log("("+a+"**3 - 1) / "+a+"**2 = "+a3.minus(1).div(a2)+" ("+a3.minus(1).mod(a2)+")"),log(""),b=new LongInt(111111112),log(""+b+" / 37 = "+b.div(37)+" ("+b.mod(37)+")"),log(""),c=new LongInt(120661737472),d=new LongInt(100280245065),log(""+c+" gcd "+d+" = "+c.gcd(d)+" (expected "+899+")"),log("")),typeof require!="undefined"?(require.paths.unshift(__dirname),LongInt=require("long_int").LongInt):LongInt=this.pazy.LongInt,Rational=function(){function e(b,c,e){var f,g,h,i;b==null&&(b=0),c==null&&(c=1),e==null&&(e=!1),g=LongInt.make(c).cmp(0);if(g===0)throw new Error("denominator is zero");g<0?(h=[LongInt.make(b).neg(),LongInt.make(c).neg()],f=h[0],d=h[1]):(i=[LongInt.make(b),LongInt.make(c)],f=i[0],d=i[1]),e?(this.num__=f,this.den__=d):(a=f.gcd(d),this.num__=f.div(a),this.den__=d.div(a))}var c;e.prototype.numerator=function(){return this.num__},e.prototype.denominator=function(){return this.den__},c=function(a){if(a instanceof e)return a;if(a instanceof LongInt)return new e(a);if(typeof a=="number")return new e(a);throw new Error(""+a+" is not a number")},e.prototype.toString=function(){return this.den__.cmp(1)===0?this.num__.toString():""+this.num__.toString()+"/"+this.den__.toString()},e.operator=function(a,b,d){var e,f,g,h;e=function(){var a,e;a=1<=arguments.length?__slice.call(arguments,0):[];return d.apply(this,function(){var d,f,g,h;g=a.slice(0,b-1),h=[];for(d=0,f=g.length;d<f;d++)e=g[d],h.push(c(e));return h}())};for(g=0,h=a.length;g<h;g++)f=a[g],this.prototype[f]=e;return null},e.operator(["neg","-"],1,function(){return new e(this.num__.neg(),this.den__,!0)}),e.operator(["inv"],1,function(){return new e(this.den__,this.num__,!0)}),e.operator(["abs"],1,function(){return new e(this.num__.abs(),this.den__,!0)}),e.operator(["sign"],1,function(){return this.num__.sign()}),e.operator(["plus","+"],2,function(b){var c,d;a=this.den__.gcd(b.den__),d=this.den__.div(a),c=b.den__.div(a).times(this.num__).plus(d.times(b.num__));return new e(c,d.times(b.den__))}),e.operator(["minus","-"],2,function(a){return this.plus(a.neg())}),e.operator(["cmp","<=>"],2,function(a){return this.minus(a).num__.cmp(0)}),e.operator(["times","*"],2,function(c){var f;a=this.num__.gcd(c.den__),b=this.den__.gcd(c.num__),f=this.num__.div(a).times(c.num__.div(b)),d=this.den__.div(b).times(c.den__.div(a));return new e(f,d,!0)}),e.operator(["div","/"],2,function(a){return this.times(a.inv())}),e.operator(["pow","**"],2,function(a){if(a.den__.cmp(1)!==0)throw new Error("exponent must be an integer");return new e(this.num__.pow(a.num__),this.den__.pow(a.num__))});return e}(),typeof exports!="undefined"&&exports!==null?exports:exports=(_ref19=this.pazy)!=null?_ref19:this.pazy={},exports.Rational=Rational